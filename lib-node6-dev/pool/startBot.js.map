{"version":3,"sources":["../../src/pool/startBot.js"],"names":["startBot","logger","pool","team","info","teamsToProcess","has","id","warn","get","replaceTeam","process","processes","canAddTeam","startTeam","newProcess","add","newProcessListSize","size","start"],"mappings":";;;;;kBAQwBA,Q;;;;;;AAPxB;;;;AACA;;;;AACA;;;;AACA;;;;AAEA,MAAMC,SAAS,0BAAW,YAAX,CAAf;;AAEe,SAASD,QAAT,CAAkBE,IAAlB,EAA8BC,IAA9B,EAAoD;AAAA,UAAlCD,IAAkC;;AAAA,UAAtBC,IAAsB;;AAAA;AACjEF,WAAOG,IAAP,CAAY,cAAZ,EAA4BD,IAA5B;;AAEA,QAAID,KAAKG,cAAL,CAAoBC,GAApB,CAAwBH,KAAKI,EAA7B,CAAJ,EAAsC;AACpCN,aAAOO,IAAP,CAAY,qBAAZ,EAAmCL,IAAnC;AACAD,WAAKG,cAAL,CAAoBI,GAApB,CAAwBN,KAAKI,EAA7B,EAAiCG,WAAjC,CAA6CP,IAA7C;AACA;AACD;;AAED;AACA,SAAK,IAAIQ,OAAT,IAAoBT,KAAKU,SAAzB,EAAoC;AAClC,UAAID,QAAQE,UAAR,EAAJ,EAA0B;AACxBF,gBAAQG,SAAR,CAAkBX,IAAlB;AACA;AACD;AACF;;AAED,UAAMY,aAAa,sBAAYb,IAAZ,CAAnB;AACAA,SAAKU,SAAL,CAAeI,GAAf,CAAmBD,UAAnB;AACAd,WAAOG,IAAP,CAAY,oBAAZ,EAAkC,EAAEa,oBAAoBf,KAAKU,SAAL,CAAeM,IAArC,EAAlC;AACAH,eAAWI,KAAX;AACAJ,eAAWD,SAAX,CAAqBX,IAArB;AArBiE;AAsBlE","file":"startBot.js","sourcesContent":["/* @flow */\nimport Logger from 'nightingale/src';\nimport Process from './Process';\nimport Pool from './index';\nimport type { TeamType } from '../types';\n\nconst logger = new Logger('koack:pool');\n\nexport default function startBot(pool: Pool, team: TeamType): void {\n  logger.info('starting bot', team);\n\n  if (pool.teamsToProcess.has(team.id)) {\n    logger.warn('bot already started', team);\n    pool.teamsToProcess.get(team.id).replaceTeam(team);\n    return;\n  }\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (let process of pool.processes) {\n    if (process.canAddTeam()) {\n      process.startTeam(team);\n      return;\n    }\n  }\n\n  const newProcess = new Process(pool);\n  pool.processes.add(newProcess);\n  logger.info('adding new process', { newProcessListSize: pool.processes.size });\n  newProcess.start();\n  newProcess.startTeam(team);\n}\n"]}
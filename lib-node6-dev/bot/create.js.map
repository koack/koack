{"version":3,"sources":["../../src/bot/create.js"],"names":["createBot","team","rtm","bot","accessToken","logLevel","autoReconnect","autoMark","dataStore","webClient","installerUsersWebClients","Map","installations","forEach","installation","set","user","id","start"],"mappings":";;;;;kBAIwBA,S;;;;;;AAJxB;;AACA;;;;AACA;;;;AAEe,SAASA,SAAT,CAAmBC,IAAnB,EAAmC;AAAA,UAAhBA,IAAgB;;AAChD,QAAMC,MAAM,sBAAcD,KAAKE,GAAL,CAASC,WAAvB,EAAoC;AAC9CC,cAAiC,MADa;AAE9CC,mBAAe,IAF+B;AAG9CC,cAAU,IAHoC;AAI9CC,eAAW;AAJmC,GAApC,CAAZ;;AAOA,QAAMC,YAAY,sBAAcR,KAAKE,GAAL,CAASC,WAAvB,CAAlB;;AAEA,QAAMM,2BAA2B,IAAIC,GAAJ,EAAjC;AACA,MAAIV,KAAKW,aAAT,EAAwB;AACtBX,SAAKW,aAAL,CAAmBC,OAAnB,CAA2BC,gBACzBJ,yBAAyBK,GAAzB,CAA6BD,aAAaE,IAAb,CAAkBC,EAA/C,EAAmDH,aAAaE,IAAb,CAAkBZ,WAArE,CADF;;AAIAM,6BAAyBG,OAAzB,CAAiC,CAACT,WAAD,EAAca,EAAd,KAC/BP,yBAAyBK,GAAzB,CAA6BE,EAA7B,EAAiC,sBAAcb,WAAd,CAAjC,CADF;AAGD;;AAEDF,MAAIgB,KAAJ;;AAEA,SAAO,kBAAQ,EAAEjB,IAAF,EAAQC,GAAR,EAAaO,SAAb,EAAwBC,wBAAxB,EAAR,CAAP;AACD","file":"create.js","sourcesContent":["import { RtmClient, WebClient, MemoryDataStore } from '@slack/client';\nimport Bot from './Bot';\nimport type { TeamType } from '../types/';\n\nexport default function createBot(team: TeamType) {\n  const rtm = new RtmClient(team.bot.accessToken, {\n    logLevel: PRODUCTION ? 'error' : 'info',\n    autoReconnect: true,\n    autoMark: true,\n    dataStore: new MemoryDataStore(),\n  });\n\n  const webClient = new WebClient(team.bot.accessToken);\n\n  const installerUsersWebClients = new Map();\n  if (team.installations) {\n    team.installations.forEach(installation => (\n      installerUsersWebClients.set(installation.user.id, installation.user.accessToken)\n    ));\n\n    installerUsersWebClients.forEach((accessToken, id) => (\n      installerUsersWebClients.set(id, new WebClient(accessToken))\n    ));\n  }\n\n  rtm.start();\n\n  return new Bot({ team, rtm, webClient, installerUsersWebClients });\n}\n"]}